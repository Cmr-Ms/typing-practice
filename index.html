<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>実用入力練習</title>
  <meta name="description" content="変換ありのタイピング練習ができます。">
  <meta name="keywords" content="タイピング, 実用入力, 変換, タイピング練習">
  <style>
    body{
      color: rgb(0, 255, 0);
      background: black;
    }
    #mainframe{
      text-align: center;
      width: 100%;
      height: 70%;
      
    }
    #sentencearea{
      font-size: 32px;
      background: rgb(0, 50, 0);
    }
    #nextsentence{
      font-size: 24px;
      background: rgb(0, 50, 0);
    }
    #typearea{
      font-size: 22px;
      width: 800px;
      height: 100px;
    }
    #wordsarea{
      font-size: 20px;
      width: 600px;
      height: 100px;
    }
    select{
      font-size: 20px;
    }
    textarea{
      background: black;
      color: rgb(0, 255, 0);
      font-size: 32px;
    }
    button{
      font-size: 30px;
    }
    input[type="number"]{
      font-size: 30px;
    }
  </style>
</head>
<body>
<div id="mainframe">
  <a id="sentencearea"></a><br>
  <a id="nextsentence"></a><br>
  <textarea id="typearea" autofocus placeholder="一番上の文を入力するとカウントダウンが始まります。改行した時点で1文字以上正解の文字があると次のワードに切り替わります(完全に正解の場合は改行も文字数にカウントされます)"></textarea><br>
  <a id="progress"></a><br>
  <a id="countdown"></a><br>
  <textarea id="wordsarea" placeholder="改行区切りでワードを入力  長文モードを使う場合はワードの分け目に改行を2つ入れてください"></textarea><br>
  <input id="seconds" type="number" value="60" onchange="seconds=Number(this.value);reset()">
  <label>秒</label>
  <input id="longwordmode" type="checkbox" checked onclick="allwords=wordsarea.value.split('\n\n').filter(e=>Boolean(e));reset()"><label>長文モード</label>
  <input id="wordsmode" type="checkbox" onchange="reset()">
  <label>ワード数モード</label><br>
  <input id="until_words" type="number" value="10" onchange="until_words=Number(this.value);allwords=wordsarea.value.split('\n'.repeat(1+longwordmode.checked)).filter(e=>Boolean(e));reset()">
  <label>ワード</label><br>
  <button onclick="reset()">リセット</button><br>
  <a href="https://github.com/Cmr-Ms/typing-practice/tree/main" target="_blank">追加のワード  はこちらから</a><br>
  <a href="https://forms.gle/5AfvtdjJMF1s87c49" target="_blank">ご意見などはこちらから</a>
</div>

  <script>
    const sentencearea = document.querySelector("#sentencearea");
    const nextsentence = document.querySelector("#nextsentence")
    const typearea = document.querySelector("#typearea");
    const progress = document.querySelector("#progress");
    const wordsarea = document.querySelector("#wordsarea");
    const wordsmode = document.querySelector("#wordsmode")
    const longwordmode = document.querySelector("#longwordmode")
    const countdown = document.querySelector("#countdown")
    const timerseconds = document.querySelector("#seconds")
    wordsarea.value = `社説：日本経済の再生　次世代担う人への投資を\n　国力低下の表れではないか。昨年の歴史的な円安と物価高は国民生活や企業活動を直撃し、日本経済のもろさを浮き彫りにした。\n　ウクライナ危機に伴うエネルギー価格の高騰で、輸入額が急拡大した。一方「メード・イン・ジャパン」の売り物は乏しく、貿易赤字は過去最大に膨らんでいる。経済政策や産業のあり方を根本から問い直す時期に来ている。\n　バブル経済の崩壊以降、日本は長らく低成長とデフレにあえいできた。「失われた２０年」にどう対応すべきか。鳴り物入りで登場したのがアベノミクスだった。\n　２０１２年末の政権交代後、当時の安倍晋三首相は「最大かつ喫緊の課題は経済の再生」と訴えた。大胆な金融政策、機動的な財政政策、民間投資を喚起する成長戦略という「三本の矢」で経済を立て直す考えを表明した。\n　中核となったのが、市場に大量のマネーを流し込む異次元の金融緩和だ。日銀の黒田東彦総裁は「２年程度で２％の物価安定目標を達成できる」と豪語した。\n　円安と株高を演出し、グローバル企業の業績を押し上げたのは確かだ。しかし、企業は稼いだ利益で内部留保を積み上げ、成長を求めて海外への投資に力を注いだ。\n　産業空洞化の流れは止まらず、経済の好循環は実現していない。とりわけ問題なのは、恩恵が大企業や富裕層などに偏り、幅広い働き手に及んでいない点だ。\n　賃金は伸び悩み、非正規労働者は増え続けた。企業は２０００万人を超える非正規を、雇用の調整弁にしている。\n　異次元の緩和が、財政規律を失わせていることも見逃せない。\n　新型コロナウイルスの感染拡大を受け、政府は景気対策を繰り返し、国債発行額は、２０年度に１００兆円を超えた。超低金利で、利払い費が抑えられてきたことが背景にある。防衛費も大幅に増額し、異次元の財政悪化を招いている。\n　もはやアベノミクスの限界は明らかだ。金融政策を見直し、財政運営を正常化すべきだ。そのうえで、日本経済を支える新たな産業の創出を急ぐ必要がある。\n　求められるのは、地球規模の課題に取り組み、ライフスタイルを変えるような事業への挑戦だ。\n　ソニーグループは、ホンダと組み、環境車として本命視される電気自動車の開発に乗り出した。２５年に最初の車を発売する。\n　合弁会社の社長には、ゲーム機や犬型ロボット、携帯電話などの開発に携わってきた人材を起用した。音楽や映像、センサーなど多分野の技術を結集し、「移動空間をエンターテインメントの空間にする」ことを目指す。\n　一方、１１年に東京で設立された新興企業のＴＢＭは、日本でも豊富な資源量を誇る石灰石を原料に、紙やプラスチックの代替素材を、開発・製造している。\n　森林破壊が懸念される木材パルプを使わず、石油由来のプラスチック使用量も減らせる。石灰石が持つ可能性に着目した創業者が、大手製紙会社元役員の協力を得て、新素材の開発にこぎつけた。\n　１万社以上が、名刺や会社説明の冊子、レジ袋、食品容器などに採用している。「サステナビリティー（持続可能性）革命を実現する」という目標に共感し、大企業の出身者らが入社している。\n　企業のイノベーションに詳しい早稲田大の清水洋教授は「経営資源が豊富な既存企業が新たなビジネスに参入する一方、研究開発型のスタートアップを増やすことが重要になる」と強調する。\n　成功のカギを握るのは、人材を確保しやすい環境の整備だ。清水教授は「自発的な労働移動を増やせるかがポイント」と指摘する。\n　成長分野で働く人を増やすため、岸田文雄首相はリスキリング（学び直し）に５年間で１兆円の支援をすると表明しているが、実効性が問われる。\n　企業は新事業で活躍する人材を育てる。政府は個々人の学び直しを直接支援し、働きがいがあって待遇の良い仕事を選べるようにする。離職せずに自分の技能を試す副業や兼業も普及させていく。\n　実行する際には「人件費はコスト」という考え方から脱却し、「人材は貴重な経営資源」との認識を広めていくことが不可欠だ。\n　人材重視の経営で新たな分野にチャレンジする機運を高め、産業構造の転換を図る。それこそが日本の未来を切り開く道だ。\n毎日新聞　２０２３年１月１０日\n余録：「継がれゆくもの」と題された催しの案内が届いた…\n　「継がれゆくもの」と題された催しの案内が届いた。エッセイストの鮫島純子さんと、孫で起業家の弘子さんによる二人展。純子さんは、９月に百寿を迎え、新刊を出すなど「人生１００年時代」の先頭を軽やかに歩いている▲健康長寿のひけつは「感謝すること、好奇心を持つこと、年齢を考えないこと」という。手縫いのワンピースの胸元に、小粒の真珠をあしらったブローチが輝いていた。語り継ぎたい物語がある▲大正時代、世界で初めて真珠の養殖技術を確立した御木本幸吉が、欧州の宝石商から「模造品」と言いがかりをつけられた。裁判で真正性を証明したものの、訴訟費用が巨額で窮地に陥る。手を差し伸べたのは、実業家の渋沢栄一だった▲そのお礼にと後日、渋沢家の女たちが銀座の本店に招かれた。食事に出されたアコヤガイのフライの中に潜んでいた小さな真珠を集め、ブローチとして娘に残したのは純子さんの母親だ。「不ぞろいですけれど、大切な祖父の思い出です」。純子さんは栄一の孫にあたる▲やしゃごの弘子さんも、食肉加工の後捨てられる上質な羊の皮を使い、バッグのブランドを立ち上げて１０年になる。エチオピアで職人を育成し、縫製まで手がけることで現地経済にも貢献できる▲二人が受け継いだのは、ものを粗末にしない「質素倹約」の生き方であり、栄一が生涯追い求めた「論語と算盤」の精神だろう。その血を受け継ぐことはできなくても、次世代に渡せるものは何かと思いを巡らせてみる。\n毎日新聞　２０２２年１１月２８日\n`
    allwords=wordsarea.value.split(RegExp(`\\n{${1+longwordmode.checked},}`)).filter(e=>Boolean(e))
    typedchars = 0
    typedlines = 0
    wastingtime = Number(localStorage.getItem("wastingtime") ? localStorage.getItem("wastingtime") : 0)
    function reset(){
      wordtotype = "";
      multilineword = []
      nextword = ""
      typearea.value=""
      started = false
      starttime = 0
      endtime = 0
      typedchars = 0
      typedlines = 0
      typedwords = 0
      seconds = Number(timerseconds.value)
      countdown.innerText = `残り ${seconds} 秒`
      changeprogress()
      changeword()
      clearTimeout(timer)
      timer = 0
      try{clearInterval(countdowntimer)}catch{}
    }

    function changeprogress(){
      progress.innerText = `${typedchars} 文字, ${typedlines}行, ${typedwords}ワード, 浪費した時間 約 ${Math.round(wastingtime)} 秒\n最高スコア ${localStorage.getItem(`highscore${seconds}`) ? localStorage.getItem(`highscore${seconds}`) : 0} 文字`
    }
    function changeword(){
      changeprogress()
      multilineword.push(...allwords[Math.floor(allwords.length * Math.random())].split("\n"))
      wordtotype = multilineword[0]
      if(!multilineword[1]){
        multilineword.push(...allwords[Math.floor(allwords.length * Math.random())].split("\n"))
      }
      nextword = multilineword[1]
      multilineword = multilineword.slice(1)
      sentencearea.innerText = wordtotype
      nextsentence.innerHTML = "<b>次: </b>"+nextword
      typearea.value = "";
      typearea.style["background-color"] = "rgb(0, 0, 0)"
    }
    function updatestorage(){
      
      localStorage.setItem(`highscore${seconds}`, (typedchars) >= Number(localStorage.getItem(`highscore${seconds}`)) ? (typedchars) : 0)
      localStorage.setItem("wastingtime", wastingtime)
    }
    wordsarea.addEventListener("input", (e)=>{
      allwords=wordsarea.value.split("\n".repeat(1+longwordmode.checked)).filter(e=>Boolean(e));reset();
    })

    window.onload = ()=>{
      reset()
    }

    typearea.addEventListener("input", (e)=>{
      if(!started && typearea.value){
        started = true
        starttime = Date.now()
        if(!wordsmode.checked){endtime = starttime + 1000*seconds;timer = setTimeout(
          ()=>{
            if(typearea.value){
              try{
                typedchars += wordtotype.match(new RegExp("(\\"+typearea.value.split("").join(")?(\\")+")?", "g")).join("").length
              }catch{}
            }
            try{clearInterval(countdowntimer)}catch{}
            alert(`${typedchars} 文字, ${typedlines} 行, ${typedwords}ワード`);console.log(`${typedchars} 文字, ${typedlines} 行, ${typedwords}ワード`);document.title = `${typedchars} 文字 - 実用入力練習`
            updatestorage()
            reset()
          }, endtime - starttime
        )}

        countdowntimer = setInterval(
          ()=>{
            if(timer){countdown.innerText = `残り ${Math.floor((endtime - Date.now()) / 1000)} 秒`}
          }, 100
        )

      }
      if((e.inputType === "insertLineBreak" || (e.inputType === "insertText" && (!e.data || e.data ===  "\n")))){
        if(typearea.value.replace("\n", "") === wordtotype){
          typedchars += typearea.value.length
          typedlines++
          if(!multilineword[1]){typedwords++}
          if(!timer && wordsmode.checked && typedwords === until_words){
            alert(`${typedchars / ((Date.now() - starttime) / 1000)}文字/秒\n${typedchars / ((Date.now() - starttime) / 1000)*60}文字/分`);console.log(`${typedchars / ((Date.now() - starttime) / 1000)}/秒, ${until_words}`);document.title = `${typedchars / ((Date.now() - starttime) / 1000)}文字/秒 - 実用入力練習`
            updatestorage()
            reset()
          }else{
            changeword()
          }
          
        }//else{typedchars += typearea.value.match(new RegExp(`(\\${wordtotype.split("").join(")?(\\")})?`, "g")).join("").length}
        
      }if(wordtotype.startsWith(typearea.value) && typearea.value){
        typearea.style["background-color"] = "rgb(0, 100, 0)"

      }else if(!wordtotype.startsWith(typearea.value) && typearea.value){
        typearea.style["background-color"] = "rgb(100, 0, 0)"

      }else{
        typearea.style["background-color"] = "rgb(0, 0, 0)"
      }
    })

    typearea.addEventListener("keydown", (e)=>{
      if(e.key === "Escape"){
        wastingtime += endtime ? (seconds - ((endtime - Date.now()) / 1000)) : 0

        reset()
        try{
          clearTimeout(timer)
        }catch(e){}
      }
    })
  </script>

</body>
</html>
